<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Continuous Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile | Tim Engle Blog</title>
<meta name=keywords content><meta name=description content="The references to a blog in this post are for my older blog that was built from
scratch using Go. My new blog is built using Hugo and the Papermod.
In the previous post, the importance of setting up continuous deployment (CD) was introduced, and a basic GitHub Actions workflow was created to automate code deployments. In this section of the series, we’ll build on that foundation by discussing three essential files needed for fully automating the deployment process. The first is a more advanced GitHub Actions workflow that will handle all the steps required to deploy updated containers to GCP. The second is a build script that will create a binary of the Go application compatible with the operating system running inside the Docker container. Finally, we’ll cover the Dockerfile, which is responsible for building the container image that will be deployed and hosted by Google Cloud Platform."><meta name=author content="Tim Engle"><link rel=canonical href=http://localhost:1313/posts/gcp-continuous-deployment-2/><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/gcp-continuous-deployment-2/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-FS6MC4ZS4L"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FS6MC4ZS4L")}</script><meta property="og:url" content="http://localhost:1313/posts/gcp-continuous-deployment-2/"><meta property="og:site_name" content="Tim Engle Blog"><meta property="og:title" content="Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile"><meta property="og:description" content="The references to a blog in this post are for my older blog that was built from scratch using Go. My new blog is built using Hugo and the Papermod.
In the previous post, the importance of setting up continuous deployment (CD) was introduced, and a basic GitHub Actions workflow was created to automate code deployments. In this section of the series, we’ll build on that foundation by discussing three essential files needed for fully automating the deployment process. The first is a more advanced GitHub Actions workflow that will handle all the steps required to deploy updated containers to GCP. The second is a build script that will create a binary of the Go application compatible with the operating system running inside the Docker container. Finally, we’ll cover the Dockerfile, which is responsible for building the container image that will be deployed and hosted by Google Cloud Platform."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-22T17:44:14-08:00"><meta property="article:modified_time" content="2024-08-22T17:44:14-08:00"><meta property="og:image" content="http://localhost:1313/img/card.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/img/card.webp"><meta name=twitter:title content="Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile"><meta name=twitter:description content="The references to a blog in this post are for my older blog that was built from
scratch using Go. My new blog is built using Hugo and the Papermod.
In the previous post, the importance of setting up continuous deployment (CD) was introduced, and a basic GitHub Actions workflow was created to automate code deployments. In this section of the series, we’ll build on that foundation by discussing three essential files needed for fully automating the deployment process. The first is a more advanced GitHub Actions workflow that will handle all the steps required to deploy updated containers to GCP. The second is a build script that will create a binary of the Go application compatible with the operating system running inside the Docker container. Finally, we’ll cover the Dockerfile, which is responsible for building the container image that will be deployed and hosted by Google Cloud Platform."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile","item":"http://localhost:1313/posts/gcp-continuous-deployment-2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile","name":"Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile","description":"The references to a blog in this post are for my older blog that was built from scratch using Go. My new blog is built using Hugo and the Papermod.\nIn the previous post, the importance of setting up continuous deployment (CD) was introduced, and a basic GitHub Actions workflow was created to automate code deployments. In this section of the series, we’ll build on that foundation by discussing three essential files needed for fully automating the deployment process. The first is a more advanced GitHub Actions workflow that will handle all the steps required to deploy updated containers to GCP. The second is a build script that will create a binary of the Go application compatible with the operating system running inside the Docker container. Finally, we’ll cover the Dockerfile, which is responsible for building the container image that will be deployed and hosted by Google Cloud Platform.\n","keywords":[],"articleBody":"The references to a blog in this post are for my older blog that was built from scratch using Go. My new blog is built using Hugo and the Papermod.\nIn the previous post, the importance of setting up continuous deployment (CD) was introduced, and a basic GitHub Actions workflow was created to automate code deployments. In this section of the series, we’ll build on that foundation by discussing three essential files needed for fully automating the deployment process. The first is a more advanced GitHub Actions workflow that will handle all the steps required to deploy updated containers to GCP. The second is a build script that will create a binary of the Go application compatible with the operating system running inside the Docker container. Finally, we’ll cover the Dockerfile, which is responsible for building the container image that will be deployed and hosted by Google Cloud Platform.\nGitHub Actions Workflow To fully automate the CD pipeline, a service is needed to handle the entire process. In this series, GitHub Actions will be the tool of choice. The GitHub Actions Workflow will follow these steps to deploy new containers in the cloud, making them accessible to users:\nCheckout the code Setup Go Build a Binary of the Go application Authorize Google Cloud Platform Set up \u0026 verify the Google Cloud SDK Build and push the Docker container to Google Cloud Deploy the newly built container The initial GitHub Workflow below covers steps 1 and 2. Additional steps will be added throughout the series:\non: push: branches: [main] jobs: deploy: name: Deploy runs-on: ubuntu-latest steps: # Checkout the repository code - name: Checkout code uses: actions/checkout@v4 # Set up Go environment - name: Setup Go uses: actions/setup-go@v5 with: go-version: \"1.22.1\" In simple terms, whenever code is pushed to the main branch of the repository, this workflow will execute on an instance running the latest version of Ubuntu, performing steps 1 and 2 outlined above.\nBuild Script To ensure the Go binary is compatible with the Docker container’s OS and architecture, the build process on GitHub Actions needs to match the container’s environment. The build will be done on Ubuntu, the default operating system provided by GitHub Actions. To control this, a build script called buildprod.sh will be placed in a scripts directory. This script will generate a binary that meets the container’s requirements.\n#!/bin/bash # Set environment variables for cross-compilation export GOOS=linux export GOARCH=amd64 # Build the Go application go build -o timengledev_blog ./cmd/web Before adding a step to execute this script within the GitHub Actions workflow, ensure the script is executable by running the following command from the root of the repository:\nchmod +x scripts/buildprod.sh Adding a build step to the workflow Now that an executable script is in place to build the Go application into a binary, a step needs to be added to execute the script in the workflow.\non: push: branches: [main] jobs: deploy: name: Deploy runs-on: ubuntu-latest steps: # Checkout the repository code - name: Checkout code uses: actions/checkout@v4 # Set up Go environment - name: Setup Go uses: actions/setup-go@v5 with: go-version: \"1.22.1\" # Build the production binary - name: Build Binary run: ./scripts/buildprod.sh Creating a Dockerfile The Dockerfile is what defines how the container image for the Go application is built. This file provides the instructions Docker needs to package the Go binary, along with any dependencies, into a container that can be easily deployed and managed in Google Cloud Platform. Below is the Dockerfile used for this project:\n# Use a specific version of Debian to ensure consistency FROM --platform=linux/amd64 debian:stable-slim RUN apt-get update \u0026\u0026 apt-get install -y ca-certificates # Copy the blog binary into the container's working directory COPY ./timengledev_blog ./timengledev_blog # Specify the entrypoint to run the blog binary CMD [\"./timengledev_blog\"] Breaking down the Dockerfile Base Image Selection: The FROM instruction specifies the base image. In this case, debian:stable-slim is used to keep the container lightweight and stable. The --platform=linux/amd64 ensures the image runs consistently across different environments, matching the architecture set during the build script. Installing Dependencies: The RUN command updates the package lists and installs ca-certificates, which is often needed for HTTPS connections. Keeping dependencies minimal helps reduce the overall image size. Copying the Binary: The COPY instruction moves the timengledev_blog binary generated by the build script into the container’s working directory. This is the executable that the container will run. Setting the Entrypoint: Finally, the CMD specifies the entrypoint for the container, telling Docker to run the timengledev_blog binary when the container starts. Conclusion With the GitHub Actions workflow, build script, and Dockerfile in place, the foundation for our continuous deployment pipeline is set. These files ensure that every time a change is pushed to the main branch, the Go application is built and packaged into a Docker container that’s ready for deployment.\nIn the next part of this series, the focus will shift to configuring Google Cloud Platform. We’ll start by setting up and managing our Docker containers in the cloud using Artifact Registry. From there, we’ll explore Cloud Run to deploy our containers with autoscaling capabilities, ensuring a seamless and scalable deployment process.\nStay tuned as we continue to build out this CD pipeline and take the next steps toward fully automating the deployment of our Go-powered blog.\n","wordCount":"882","inLanguage":"en","image":"http://localhost:1313/img/card.webp","datePublished":"2024-08-22T17:44:14-08:00","dateModified":"2024-08-22T17:44:14-08:00","author":{"@type":"Person","name":"Tim Engle"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/gcp-continuous-deployment-2/"},"publisher":{"@type":"Organization","name":"Tim Engle Blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Continuous Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile</h1><div class=post-meta><span title='2024-08-22 17:44:14 -0800 -0800'>August 22, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;882 words&nbsp;·&nbsp;Tim Engle</div></header><div class=post-content><p><em>The references to a blog in this post are for my older blog that was built from
scratch using Go. My new blog is built using Hugo and the Papermod.</em></p><p>In the <a href=https://timengle.dev/posts/dynamic-file-serving-with-embedded-file-system-and-object-storage-in-go-file-serving-with-embedded-file-system-and-object-storage-in-go/>previous post</a>, the importance of setting up continuous deployment (CD) was introduced, and a basic GitHub Actions workflow was created to automate code deployments. In this section of the series, we’ll build on that foundation by discussing three essential files needed for fully automating the deployment process. The first is a more advanced GitHub Actions workflow that will handle all the steps required to deploy updated containers to GCP. The second is a build script that will create a binary of the Go application compatible with the operating system running inside the Docker container. Finally, we’ll cover the Dockerfile, which is responsible for building the container image that will be deployed and hosted by Google Cloud Platform.</p><h2 id=github-actions-workflow>GitHub Actions Workflow<a hidden class=anchor aria-hidden=true href=#github-actions-workflow>#</a></h2><p>To fully automate the CD pipeline, a service is needed to handle the entire process. In this series, GitHub Actions will be the tool of choice. The GitHub Actions Workflow will follow these steps to deploy new containers in the cloud, making them accessible to users:</p><ol><li>Checkout the code</li><li>Setup Go</li><li>Build a Binary of the Go application</li><li>Authorize Google Cloud Platform</li><li>Set up & verify the Google Cloud SDK</li><li>Build and push the Docker container to Google Cloud</li><li>Deploy the newly built container</li></ol><p>The initial GitHub Workflow below covers steps 1 and 2. Additional steps will be added throughout the series:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>main]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Checkout the repository code</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Checkout code</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Set up Go environment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup Go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/setup-go@v5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>go-version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.22.1&#34;</span><span class=w>
</span></span></span></code></pre></div><p>In simple terms, whenever code is pushed to the <code>main</code> branch of the repository, this workflow will execute on an instance running the latest version of Ubuntu, performing steps 1 and 2 outlined above.</p><hr><h2 id=build-script>Build Script<a hidden class=anchor aria-hidden=true href=#build-script>#</a></h2><p>To ensure the Go binary is compatible with the Docker container’s OS and architecture, the build process on GitHub Actions needs to match the container’s environment. The build will be done on Ubuntu, the default operating system provided by GitHub Actions. To control this, a build script called <code>buildprod.sh</code> will be placed in a <code>scripts</code> directory. This script will generate a binary that meets the container&rsquo;s requirements.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=c1># Set environment variables for cross-compilation</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOOS</span><span class=o>=</span>linux
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOARCH</span><span class=o>=</span>amd64
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Build the Go application</span>
</span></span><span class=line><span class=cl>go build -o timengledev_blog ./cmd/web
</span></span></code></pre></div><p>Before adding a step to execute this script within the GitHub Actions workflow, ensure the script is executable by running the following command from the root of the repository:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>chmod +x scripts/buildprod.sh
</span></span></code></pre></div><h3 id=adding-a-build-step-to-the-workflow>Adding a build step to the workflow<a hidden class=anchor aria-hidden=true href=#adding-a-build-step-to-the-workflow>#</a></h3><p>Now that an executable script is in place to build the Go application into a binary, a step needs to be added to execute the script in the workflow.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>main]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Checkout the repository code</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Checkout code</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Set up Go environment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup Go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/setup-go@v5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>go-version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.22.1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Build the production binary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build Binary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>./scripts/buildprod.sh</span><span class=w>
</span></span></span></code></pre></div><hr><h2 id=creating-a-dockerfile>Creating a Dockerfile<a hidden class=anchor aria-hidden=true href=#creating-a-dockerfile>#</a></h2><p>The Dockerfile is what defines how the container image for the Go application is built. This file provides the instructions Docker needs to package the Go binary, along with any dependencies, into a container that can be easily deployed and managed in Google Cloud Platform. Below is the Dockerfile used for this project:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># Use a specific version of Debian to ensure consistency</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> --platform=linux/amd64 debian:stable-slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt-get update <span class=o>&amp;&amp;</span> apt-get install -y ca-certificates<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Copy the blog binary into the container&#39;s working directory</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./timengledev_blog ./timengledev_blog<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Specify the entrypoint to run the blog binary</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;./timengledev_blog&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><h3 id=breaking-down-the-dockerfile>Breaking down the Dockerfile<a hidden class=anchor aria-hidden=true href=#breaking-down-the-dockerfile>#</a></h3><ol><li><strong>Base Image Selection</strong>: The <code>FROM</code> instruction specifies the base image. In this case, <code>debian:stable-slim</code> is used to keep the container lightweight and stable. The <code>--platform=linux/amd64</code> ensures the image runs consistently across different environments, matching the architecture set during the build script.</li><li><strong>Installing Dependencies</strong>: The <code>RUN</code> command updates the package lists and installs <code>ca-certificates</code>, which is often needed for HTTPS connections. Keeping dependencies minimal helps reduce the overall image size.</li><li><strong>Copying the Binary</strong>: The <code>COPY</code> instruction moves the <code>timengledev_blog</code> binary generated by the build script into the container’s working directory. This is the executable that the container will run.</li><li><strong>Setting the Entrypoint</strong>: Finally, the <code>CMD</code> specifies the entrypoint for the container, telling Docker to run the <code>timengledev_blog</code> binary when the container starts.</li></ol><hr><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>With the GitHub Actions workflow, build script, and Dockerfile in place, the foundation for our continuous deployment pipeline is set. These files ensure that every time a change is pushed to the <code>main</code> branch, the Go application is built and packaged into a Docker container that’s ready for deployment.</p><p>In the <a href=https://timengle.dev/posts/view/Continuous+Deployment%3A+Automating+GCP+Deployments+with+Artifact+Registry+and+Cloud+Run>next part</a> of this series, the focus will shift to configuring Google Cloud Platform. We’ll start by setting up and managing our Docker containers in the cloud using <a href=https://cloud.google.com/artifact-registry>Artifact Registry</a>. From there, we’ll explore <a href=https://cloud.google.com/run>Cloud Run</a> to deploy our containers with autoscaling capabilities, ensuring a seamless and scalable deployment process.</p><p>Stay tuned as we continue to build out this CD pipeline and take the next steps toward fully automating the deployment of our Go-powered blog.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/gcp-continuous-deployment-3/><span class=title>« Prev</span><br><span>Continuous Deployment: Automating GCP Deployments with Artifact Registry and Cloud Run</span>
</a><a class=next href=http://localhost:1313/posts/gcp-continuous-deployment-1/><span class=title>Next »</span><br><span>Continuous Deployment: Getting Started with CD for Containerized Go Apps Using GitHub Actions & GCP</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile on x" href="https://x.com/intent/tweet/?text=Continuous%20%20Deployment%3a%20Creating%20a%20GitHub%20Workflow%2c%20Build%20Script%2c%20and%20Dockerfile&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fgcp-continuous-deployment-2%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fgcp-continuous-deployment-2%2f&amp;title=Continuous%20%20Deployment%3a%20Creating%20a%20GitHub%20Workflow%2c%20Build%20Script%2c%20and%20Dockerfile&amp;summary=Continuous%20%20Deployment%3a%20Creating%20a%20GitHub%20Workflow%2c%20Build%20Script%2c%20and%20Dockerfile&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fgcp-continuous-deployment-2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fgcp-continuous-deployment-2%2f&title=Continuous%20%20Deployment%3a%20Creating%20a%20GitHub%20Workflow%2c%20Build%20Script%2c%20and%20Dockerfile"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fgcp-continuous-deployment-2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile on whatsapp" href="https://api.whatsapp.com/send?text=Continuous%20%20Deployment%3a%20Creating%20a%20GitHub%20Workflow%2c%20Build%20Script%2c%20and%20Dockerfile%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fgcp-continuous-deployment-2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile on telegram" href="https://telegram.me/share/url?text=Continuous%20%20Deployment%3a%20Creating%20a%20GitHub%20Workflow%2c%20Build%20Script%2c%20and%20Dockerfile&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fgcp-continuous-deployment-2%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Continuous  Deployment: Creating a GitHub Workflow, Build Script, and Dockerfile on ycombinator" href="https://news.ycombinator.com/submitlink?t=Continuous%20%20Deployment%3a%20Creating%20a%20GitHub%20Workflow%2c%20Build%20Script%2c%20and%20Dockerfile&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fgcp-continuous-deployment-2%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Tim Engle Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>